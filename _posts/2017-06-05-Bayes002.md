---
layout:     post
title:      "贝叶斯思维（笔记）"
subtitle:   "（2）统计计算"
date:       2017-06-05 20:00:00
author:     "Ju"
header-img: "img/post-bg-pj.jpg"
tags:
    - Bayes
    - 笔记
--- 

# 分布

**分布：**是一组值及其对应的概率。

> 第一次看到这种定义，仔细想想，没毛病...

例如，如果滚动一个六面骰子，可能的值是数字1到6，而每个值关联的概率是1/6.

为了表示Python中的分布，`thinkbayes2`提供了一个名为`Pmf`的类，利用Python字典实现了映射某个值和它的概率的功能。

一个六面骰子的结果分布：

```python
from thinkbayes2.py import Pmf

pmf = Pmf()
for x in [1, 2, 3, 4, 5, 6]:
	pmf.Set(x, 1/6.0)
```

另一个例子是计算每个单词在一个次序列中出现的次数：

```python
pmf = Pmf()
for word in word_list:
	pmf.Incr(word, 1)
```

`Incr`为每个`word`的“概率”加1。

`Normalize`可以标准化上面的“概率”得到真正的概率。


# 曲奇饼问题

设置先验分布：

```python
pmf = Pmf()

pmf.Set('Bowl1', 0.5)
pmf.Set('Bowl2', 0.5)
```

**似然度：**从碗1拿到香草曲奇饼的可能性是3/4，碗2则是1/2.

`Mult`将先验概率乘以已知的似然度，最后通过`Normalize`标准化后验概率：

```python
pmf.Mult('Bowl1', 0.75)
pmf.Mult('Bowl2', 0.5)

pmf.Normalize()

pmf.Print()
```

# 贝叶斯框架

定义一个**类**来封装一个贝叶斯更新过程：

```python
class Cookie(Pmf):
    """A map from string bowl ID to probablity."""

    def __init__(self, hypos):
        """Initialize self.

        hypos: sequence of string bowl IDs
        """
        Pmf.__init__(self)
        for hypo in hypos:
            self.Set(hypo, 1)
        self.Normalize()

    def Update(self, data):
        """Updates the PMF with new data.

        data: string cookie type
        """
        for hypo in self.Values():
            like = self.Likelihood(data, hypo)
            self.Mult(hypo, like)
        self.Normalize()

    mixes = {
        'Bowl 1':dict(vanilla=0.75, chocolate=0.25),
        'Bowl 2':dict(vanilla=0.5, chocolate=0.5),
        }

    def Likelihood(self, data, hypo):
        """The likelihood of the data under the hypothesis.

        data: string cookie type
        hypo: string bowl ID
        """
        mix = self.mixes[hypo]
        like = mix[data]
        return like
```













# 贝叶斯定理

$$ p(H|D)=\frac{p(H)p(D|H)}{p(D)} $$

　　这就是贝叶斯公式，就这么一个公式搞出了一大堆难懂的理论！当年小瞧了这个公式真的是Naive！！下面就通过几个例子来理解它吧。

___

## 曲奇饼问题

> 假设有两碗曲奇饼，碗1包含30个`香草`曲奇饼和10个`巧克力`曲奇饼，碗2有上述两种饼干各20个，现在随机拿一块饼，得到了一块`香草`曲奇饼。

**问**：从碗1取到的这块香草曲奇饼的概率是多少？

**标记**：就让碗是$B$，`香草`曲奇饼作为事件$V$。

**分析**：我们想要得到的是 $ p(B\_1 \| V) $ ，直接带到贝叶斯公式就可以得到：

$$ p(B_1|V) = \frac{p(B_1)p(V|B_1)}{p(V)} $$

　　这样就能计算出“这块`香草`曲奇饼是从`碗1`取出来的概率”。那这个概率有什么用呢？我现在的理解就是这个贝叶斯后验概率是事后根据事件发生的结果对事件发生时的条件的一个推断。先不管那么多了，接着看吧。

---

## M&M豆问题

> M&M豆是有各种颜色的糖果巧克力豆。制造M&M豆的Mars公司会不时变更不同颜色巧克力豆之间的混合比例。

下面是两袋M&M豆中各颜色巧克力豆的比例：

|颜色		|1994年		|1996年		|
|:---------:|:---------:|:---------:|
|褐色		|30%		|13%		|	
|黄色		|20%		|14%		|
|红色		|20%		|13%		|
|绿色		|10%		|20%		|
|橙色		|10%		|16%		|
|蓝色		|无			|24%		|
|黄褐色		|10%		|无 		|

**问**：一个人从每个袋子（不知道年份）里各取了一个M&M豆，一个是`黄色`，一个是`绿色`的。那么`黄色豆`来自1994年的袋子的概率是多少？

首先，列举下所有的假设。取`黄色豆`的袋子称为`袋1`，取`绿色豆`的袋子称为`袋2`，则所有假设是：

1. A：`袋1`是1994年的，`袋2`是1996年的。
1. B：`袋1`是1996年的，`袋2`是1994年的。

根据假设用下面的表格进行分析：


|假设  |先验概率 $p(H)$ |似然度 $p(D\|H) $| $p(H) p(D\|H)$|后验概率 $p(H\|D)$ |
|:----:|:--------------:|:---------------:|:-------------:|:-----------------:|
|假设A |1/2				|(20)(20)		  |200			  |20/27			  |
|假设B |1/2				|(10)(14)		  |70			  |7/27				  |

- **先验概率**表示的是这两个事件本来发生的概率应该是五五开的。
- **似然度**表明了问题的背景信息，其实就是按照每个假设发生了后面的事件的概率。
- 最后用贝叶斯公式就可以算出**后验概率**。

---

## Monty Hall 难题

> Monty Hall 是游戏节目“来做个交易”（Let's Make a Deal）的主场。Monty Hall 难题也是这个节目的常规游戏之一。

游戏的规则是这样的：

- Monty 想你示意三个关闭的大门，然后告诉你每个门后都有一个奖品：一个奖品是一辆汽车，另外两个是像花生酱这样不值钱的奖品。奖品随机配置。
- 游戏的目的是要猜哪个门后有车。如果猜对了就可以拿走紫车。
- 你先挑选一扇门，我们姑且称之为门A，其他两个称为门B和门C。
- 在打开你选中的门前，Monty 会先打开B或C中一个没有车的门来增加悬念。
- 然后Monty 给你一个选择。坚持最初的选择还是换到剩下的未打开的门上。

**问题**：你应该“坚持”还是“换”？有没有区别？

~~大多数人可能觉得没什么区别，换不换车在剩下两个门后的概率都应该是50%~~

看看贝叶斯方法怎么解决吧！

**精确描述：**事件`D`为Monty 打开了门B，而门B后面没有车。

**表格分析：**

|假设  |先验概率 $p(H)$ |似然度 $p(D\|H) $| $p(H) p(D\|H)$|后验概率 $p(H\|D)$ |
|:----:|:--------------:|:---------------:|:-------------:|:-----------------:|
|假设A |1/3				|1/2			  |1/6			  |1/3				  |
|假设B |1/3				|0				  |0			  |0				  |
|假设C |1/3				|1				  |1/3			  |2/3				  |

- 先验概率不说了，都一样的。
- 似然度。假设A下，Monty 选打开门B和门C的概率一样，所以是1/2；同样假设B下，Monty 是肯定不会打开门B的；假设C下，Monty 不能选择门C，所以只能打开门B。
- 后验概率用贝叶斯公式算一下就出来了。

哈哈，**贝大爷**告诉你，换一个选择可能中奖的概率更大呦！！


[**贝叶斯思维（笔记）-目录**](http://www.noodler.xyz/2017/05/15/Bayes-contents/)



